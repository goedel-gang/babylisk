(lambda M,s=list.__setitem__,m=map,l=list,z=zip,b=reversed,e=enumerate,a=range,t=tuple:(lambda g,r=lambda w:(lambda o,f:[[[s(o,f[0],"O"),s(f,0,f[0]+1)]if x=="O"else[s(o,j,"#"),s(f,0,j+1)]if x=="#"else 0for j,x in e(w)],o][1])(o=["."]*len(w),f=[0]),q=lambda I:sum(j for j,x in e(b(I),1)if x=="O"),c=lambda g,r:[s(g,0,l(z(*(m(r,z(*g[0])))))),s(g,0,l(m(r,g[0]))),s(g,0,l(z(*m(r,z(*b(g[0])))))[::-1]),s(g,0,[r(l(b(w)))[::-1]for w in g[0]]),t(m(t,g[0]))][4]:(lambda p,n,i:[all([s(g,0,c(g,r)),(g[0]not in p and(p.__setitem__(g[0],j)or 1))or(g[0]in p and(s(i,0,j)or s(n,0,j-p[g[0]])))][1]for j in a(M)),s(i,0,i[0]+(M-i[0])//n[0]*n[0]),[s(g,0,c(g,r))for j in a(i[0]+1,M)],print(sum(m(q,z(*g[0]))))])(p={g[0]:0},n=[0],i=[0]))([t(L[:-1]for L in open(0))]))(10**9)
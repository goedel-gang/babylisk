__import__("sys").setrecursionlimit(6**6),(lambda D,g,l,r:(lambda m,n,E:(lambda d:print(max(map(d,([x for i in r(m)for x in[(i,0,0),(i,n-1,2)]]+[x for j in r(n)for x in[(0,j,3),(m-1,j,1)]])))))(d=lambda t:(lambda s,X:(lambda x:[X.__setitem__(0,x),x(*t),l({t[:2]for t in s})][2])(x=lambda i,j,d:(i,j,d)in s or[s.add((i,j,d)),[0<=i+D[N][0]<m and 0<=j+D[N][1]<n and X[0](i+D[N][0],j+D[N][1],N)for N in E[g[i][j]][d]]]))(s=set(),X=[0])))(l(g),l(g[0]),{".":{i:[i]for i in r(4)},"/":{i:[i^1]for i in r(4)},"\\":{i:[i^3]for i in r(4)},"|":{0:[1,3],1:[1],2:[1,3],3:[3]},"-":{0:[0],1:[0,2],2:[2],3:[0,2]}}))([(0,1),(-1,0),(0,-1),(1,0)],[L.strip()for L in open(0)],len,range)